{% extends 'master.html' %}


{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}


<div class="dashboard-container">


<!-- Summary Cards -->
<div class="cards">
    <div class="card green">
        <div class="icon">ðŸ’°</div>
        <h3>Total Income</h3>
        <p>Rs. {{ Total_Income if Total_Income is not none else 0 }}</p>
    </div>
    <div class="card red">
        <div class="icon">ðŸ’¸</div>
        <h3>Total Expenses</h3>
        <p>Rs. {{ Total_expense if Total_expense is not none else 0 }}</p>
    </div>
    <div class="card orange">
        <div class="icon">ðŸ“Š</div>
        <h3>Total Budget</h3>
        <p>Rs. {{ summaries | sum(attribute='total_budget') }}</p>
    </div>
    <div class="card blue">
        <div class="icon">ðŸ’³</div>
        <h3>Remaining Balance</h3>
        <p>Rs. {{ summaries | sum(attribute='remaining') }}</p>
    </div>
</div>


<div class="dashboard-overview">

     <div class="expenses-overview">
       <h2>Expenses Overview</h2>
       <canvas id="myChart"></canvas>
    </div>



    <!-- Category Summary Cards -->
    <div class="budget-summary">
        <h2>Budget Summary</h2>
        {% for s in summaries %}
        <div class="summary-card">
            <h3>{{ s.category }}</h3>
            <div class="progress-container">
                 <div class="progress-bar {{ s.color_class }}"style="width: {{ s.percentage }}%;" >
                    {{ s.percentage }}%
                </div>
            </div>
            <div class="summary-info">
                <p><strong>Budget:</strong> {{ s.total_budget }}</p>
                <p><strong>Spent:</strong> {{ s.total_expense }}</p>
                <p><strong>Remaining:</strong> {{ s.remaining }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
    

{% if recent_trans %}
<div class="recent-transactions">
    <h2>Recent Transactions</h2>
    <table class="transactions-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Category</th>
                <th>Description</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for t in recent_trans %}
            <tr>
                <td>{{ t.date }}</td>
                <td>{{ t.type }}</td>
                <td>{{ t.category }}</td>
                <td>{{t.description}}</td>
                <td>{{ t.amount }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p>No recent transactions found</p>
{% endif %}
</div>

<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}