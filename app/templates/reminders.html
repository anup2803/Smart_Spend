{% extends 'master.html' %}
{% block title %}Reminders - Smart Spend{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/reminders.css') }}">
{% endblock %}

{% block content %}

  <div class="topbar">
    <div class="left">
        <span class="menu-icon">â˜°</span>
        <h3>Reminders</h3>
    </div>
     <div class="profile">
     <img src="{{ url_for('static', filename='images/profile.png') }}" alt="Profile" class="profile-pic" id="profileBtn">
       <div class="dropdown" id="profileDropdown">
        <p><strong>{{user.username}}</strong></p>
        <p><strong>{{user.email}}</strong></p>
        <a href="{{url_for('settings_bp.settings')}}">Settings</a>
        <a href="{{url_for('auth_bp.logout')}}">Logout</a>
       </div>
     </div>
  </div>

<div class="reminder-container">
    <h2 class="title">Smart Reminders</h2>
    <p class="subtitle">
        Never miss a due bill, overspend, or forget your goal again.
        Set alerts that help keep your finances on track.
    </p>

    <!-- Reminder Form -->
    <form method="POST" class="reminder-form vertical-form">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.reminder_type.label(class="form-label") }}
            {{ form.reminder_type(class="form-input") }}
        </div>

        <div class="form-group">
            {{ form.category.label(class="form-label") }}
            {{ form.category(class="form-input") }}
        </div>

        <div class="form-group">
            {{ form.due_date.label(class="form-label") }}
            {{ form.due_date(class="form-input") }}
        </div>

        <div class="form-group">
            {{ form.time.label(class="form-label") }}
            {{ form.time(class="form-input") }}
        </div>

        <div class="form-group">
            {{ form.amount.label(class="form-label") }}
            {{ form.amount(class="form-input") }}
        </div>

        <div class="form-group submit-group">
            {{ form.submit(class="btn-submit") }}
        </div>
    </form>

    <hr class="divider">

    <!-- Active Reminders Header -->
    <div class="active-reminders-header">
        <h3>Active Reminders</h3>
        <div class="header-actions">
            <!-- Export Reminders -->
            <a href="{{ url_for('reminders_bp.export_pdf') }}" class="btn-secondary">
                Export Reminders
            </a>

            <!-- Clear All Reminders -->
            <form action="{{ url_for('reminders_bp.clear_all') }}" method="POST" style="display:inline;">
                <button type="submit" class="btn-danger" onclick="return confirm('Are you sure you want to clear all reminders?');">
                    Clear All Reminders
                </button>
            </form>
        </div>
    </div>

    <!-- Reminders Table -->
    {% if reminders %}
    <table class="reminders-table">
        <thead>
            <tr>
                <th>Reminder Type</th>
                <th>Category</th>
                <th>Due Date</th>
                <th>Time</th>
                <th>Amount</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for reminder in reminders %}
            <tr>
                <td>{{ reminder.reminder_type }}</td>
                <td>{{ reminder.category }}</td>
                <td>{{ reminder.due_date }}</td>
                <td>{{ reminder.time }}</td>
                <td>{{ reminder.amount }}</td>
                <td>
                    <form action="{{ url_for('reminders_bp.edit_reminder', id=reminder.id) }}" method="post" style="display:inline;">
                        <button class="btn-edit" type="submit">Edit</button>
                    </form>
                    <form action="{{ url_for('reminders_bp.delete_reminder', id=reminder.id) }}" method="post" style="display:inline;">
                        <button class="btn-danger small-btn" type="submit">Delete</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No reminders yet.</p>
    {% endif %}
</div>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
